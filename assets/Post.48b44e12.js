import{I as $,a2 as w,_ as N,f as z,u as D,i as h,m as R,n as q,p as A,s as V,O as j,$ as O,o as n,g as c,w as m,e as H,b as I,l as M,v as U,h as a,y as L,z as S,x as G,T as J,j as K,a0 as Q}from"./app.f8ddf41f.js";import{A as W}from"./ArticleHeader.5f53bb48.js";import{u as X,C as Y}from"./Common.a77f93b1.js";import{P as Z}from"./Page.4bc1dcdc.js";import{P as ee}from"./Pager.4de5cf49.js";import"./resolveTime.46cd5efb.js";const x=({headers:k,activeLink:r})=>{const l=$();return w("ul",{class:{catalog:!0}},k.map(o=>w("li",{class:{active:r===o.slug,[`level-${o.level}`]:!0,[`toc-link-${o.slug}`]:!0},key:o.title,onClick:()=>{l.currentRoute.value.hash!==`#${o.slug}`&&l.push(`#${o.slug}`)}},o.title)))};x.displayName="Catalog";x.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const te=z({__name:"Post",setup(k){const r=K(),l=D(),o=$(),_=Q(),b=_.resolve,E=_.pending,i=X(),F=h(()=>i.value?r.value.headers:[]),y=e=>e.children.length>0?[e].concat(...e.children.map(y)):e,u=h(()=>[].concat(...F.value.map(y))),t=R({headerHeight:0,catalogTop:0,activeLink:"",isFixed:!1}),p=40,C=80,d=()=>{const e=document.querySelector(".post-header");t.headerHeight=(e==null?void 0:e.offsetHeight)||0,t.catalogTop=t.headerHeight+p};let B;q(()=>{const{y:e}=A(document),s=()=>{for(let v=u.value.length-1;v>=0;v--){const P=u.value[v].slug,T=document.querySelector(`#${P}`);if((T?T.getBoundingClientRect().top:0)<=100){t.activeLink=P;break}}e.value>t.headerHeight+p-C?(t.isFixed=!0,t.catalogTop=C):(t.isFixed=!1,t.catalogTop=t.headerHeight+p)};V(e,s),d(),B=o.afterEach(d),window.onresize=()=>{d(),s()}}),j(()=>{B()});const{post:g}=O(),f=h(()=>{if(!g.value)return{};const e=g.value.info.next;e&&(e.text=l.value.postNext);const s=g.value.info.prev;return s&&(s.text=l.value.postPrev),{next:e,prev:s}});return(e,s)=>(n(),c(Y,null,{page:m(()=>[H(J,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:a(b),onBeforeLeave:a(E)},{default:m(()=>[I("div",{class:S(["post-wrapper",{"show-catalog":a(i)}])},[M(H(W,{class:"post-header"},null,512),[[U,a(r).title]]),(n(),c(Z,{key:a(r).path,class:"post-content"},{bottom:m(()=>[a(f).next||a(f).prev?(n(),c(ee,{key:0,data:a(f)},null,8,["data"])):L("",!0)]),_:1})),a(i)?(n(),c(a(x),{key:0,headers:a(u),"active-link":t.activeLink,class:S({fixed:t.isFixed}),style:G({top:`${t.catalogTop}px`})},null,8,["headers","active-link","class","style"])):L("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var ie=N(te,[["__file","Post.vue"]]);export{ie as default};
